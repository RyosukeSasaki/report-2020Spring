%ここからソースコードの表示に関する設定
\lstset{
  basicstyle={\ttfamily},
  identifierstyle={\small},
  commentstyle={\smallitshape},
  keywordstyle={\small\bfseries},
  ndkeywordstyle={\small},
  stringstyle={\small\ttfamily},
  frame={tb},
  breaklines=true,
  columns=[l]{fullflexible},
  numbers=left,
  xrightmargin=0zw,
  xleftmargin=3zw,
  numberstyle={\scriptsize},
  stepnumber=1,
  numbersep=1zw,
  lineskip=-0.5ex
}
%ここまでソースコードの表示に関する設定
\appendix
\section{ソースコード}
ソースコードは以下のレポジトリで管理されている.\\
\url{https://github.com/RyosukeSasaki/particle-fortran}
\begin{lstlisting}[caption=メインプログラム]
program main
  use consts_variables
  implicit none
  integer, parameter :: interval = 10
  integer :: i, j
  character :: filename*128
  character :: command*128
  call omp_set_num_threads(8)

  command = 'mkdir -p ' // dir // '; rm ' // dir // '/data*'
  call system(command) 

  filename = dir // "/thrust.dat"

  open (19, file=filename, status='replace')
  write (*, *) "write data to ", dir, "/. Pressure is ", WaterPressure

  call InitParticles()
  call calcConsts()
  call writeInit()
  call output(0)
  do i = 0, 240-1
  do j = 1, interval
    call calcGravity()
    call calcViscosity()
    call moveParticleExplicit()
    call collision()
    call calcNumberDensity()
    call setBoundaryCondition()
    call setSourceTerm()
    call setMatrix()
    call GaussEliminateMethod()
    call removeNegativePressure()
    call setMinPressure()
    call calcPressureGradient()
    call moveParticleImplicit()
    call detach(i*interval+j)
    call output(i*interval+j)
  enddo
  write (*, *) "Timestep: ", (i+1)*interval
  enddo

  write (19, *) "#deltaV: ", deltaV
  close (19)

end
\end{lstlisting}
\input{code/output.tex}
\input{code/define.tex}
\input{code/func.tex}
\input{code/init.tex}
\input{code/calcconst.tex}
\input{code/calcExplicit.tex}
\input{code/calcImplicit.tex}